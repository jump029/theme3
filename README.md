# 課題3

## 実行環境
Windows 7 64bit  
python3.6.4  
numpy :  1.14.1  
matplotlib :  2.1.2  
scikit-learn :  0.19.1  
pandas :  0.22.0  

## 入力データの加工
今回は、東京都のファストフードの応募を予測した。  
(この条件に特に意味はないです。ぱっと目についたから。)   

・都道府県、市区郡、業種の項目については、データのフィルターとして使用。(特徴量としては使用しない)  
・日付については、POSIX時間に変換し、さらに、年、月、日、曜日(0,1,2,...,6)の値を特徴量に追加。  
・今回は、1日に何人応募が来るか(期間の場合は足し合わせ)を予測するため、同じ日付のものは足し合わせる。(何日に何人応募があったというデータにする)  
・応募が来ていない日は応募した人が0人だったとして学習させる。  

学習データとしては、2015/06/01 から 2015/9/30 までのものを使用し、  
テスト用データとして、2015/10/1 から 2015/10/31 までのものを使用する。  
( 東京都のファストフードの応募をプロットしたところ 2015/06/01 までのデータは欠損値があり使用していないため )  

## 実行結果
使用したアルゴリズム : ニューラルネットワーク  
隠れ層は [1000,100,100,100], alpha = 0.1 , 活性化関数は　htan , solver = 'lbfgs' を使用  
Training score :  0.6395635487488613  
Test set score :  -1.73669373855711  
実際に来た応募の数 :  19  
予測した応募の数 :  21.683503730692014   

予測した値と実際の値をプロットすると、  
![MPL](png/MPL.PNG)  
青い線が実際の値、オレンジの線が学習に使用した範囲の予測結果、緑の線が予測結果。  
足し合わせた値を見る限りはそこそこあっている気がするが、テストのスコアや実際のグラフを見る限り、うまく学習できていない気がする  

## その他のアルゴリズムについて
決定木、ランダムフォレスト、勾配ブースティング決定木、サポートベクターマシン、カーネルリッジ、線形回帰、Lasso、Ridge でも同様に予測を行った。

#### 線形回帰  
Training score :  0.036406725535479745  
Test set score :  -0.004926479257863159  
実際に来た応募の数 :  19  
予測した応募の数 :  12.314003800142018  
予測した値と実際の値をプロットすると、  
![LinearReg](png/LinearReg.PNG)  

#### Lasso  
alphaの値は10.0を使用。  
Training score :  0.016950394873702535  
Test set score :  -0.012377584955427512  
実際に来た応募の数 :  19  
予測した応募の数 :  14.946355431656492  
予測した値と実際の値をプロットすると、  
![Lasso](png/lasso.PNG)  

#### Ridge  
alphaの値は10.0を使用。  
Training score :  0.031601725100664946  
Test set score :  0.02094403602517203  
実際に来た応募の数 :  19  
予測した応募の数 :  14.919775491903152  
予測した値と実際の値をプロットすると、  
![ridge](png/ridge.PNG)  

#### Kernel Ridge  
POSIX時間を使用すると、POSIX時間に強く依存するようで、未来の予測がうまくできなかったので、このアルゴリズムのみ特徴量の POSIX時間 を消して実行。  
alphaの値は1.0を使用。  
Training score :  0.5723314680828208  
Test set score :  -0.25601511661630205  
実際に来た応募の数 :  19  
予測した応募の数 :  4.25297835376787  
予測した値と実際の値をプロットすると、  
![kernel_ridge](png/kernel_ridge.PNG)  

#### 決定木
max_depthは10を使用。  
Training score :  0.9875102375102375  
Test set score :  -1.3384912959381046  
実際に来た応募の数 :  19  
予測した応募の数 :  31.0    
予測した値と実際の値をプロットすると、  
![DecTreeReg](png/DecTreeReg.PNG)  

#### ランダムフォレスト  
Training score :  0.7167321867321867  
Test set score :  -0.07600580270793023  
実際に来た応募の数 :  19  
予測した応募の数 :  10.7  
予測した値と実際の値をプロットすると、  
![RandForest](png/RandForest.PNG)  

#### 勾配ブースティング決定木  
Training score :  0.8719069471417242  
Test set score :  -0.3186342418812482  
実際に来た応募の数 :  19  
予測した応募の数 :  18.326492491014758  
予測した値と実際の値をプロットすると、  
![GradBoostReg](png/GradBoostReg.PNG)  

#### サポートベクターマシン  
Training score :  0.9187831304902877  
Test set score :  -0.07808164272877338  
実際に来た応募の数 :  19  
予測した応募の数 :  9.073528957151812  
予測した値と実際の値をプロットすると、  
![SVR](png/SVR.PNG)  
